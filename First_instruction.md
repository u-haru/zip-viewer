# Zip Viewer

このリポジトリはZIPファイル形式のcomicをブラウザ上で閲覧するためのコードです。

## 要件

- Node.js
- React
- TypeScript
- ブラウザのみで完結
- JSZipなどを使う
- Tailwind CSS
- Material UI
- Vite
- シングルページアプリケーション
- PWA対応
- i18n対応
- ダークモード対応
- キーボードによるページ送り対応
- 画像の拡大縮小対応
  - デフォルトではフィット表示
- 目次表示対応
- Github Pagesでホスティング
  - ホスト: https://u-haru.github.io/zip-viewer/
- GitHub Actionsで自動デプロイ
- ESLint, Prettier, pre-commitによるコード整形

### 1. 機能面

#### ビューア機能

- **見開き表示 / 読み方向**
  - 単ページ表示・見開き表示の切り替え
  - 右開き（右→左） / 左開き（左→右）の指定

- **ページ移動の高度化**
  - マウスホイール / トラックパッドでのスクロール連動（1ページスクロール / 連続スクロールモード切替）
  - サムネイル一覧（フィルムストリップ）でのページジャンプ
  - ページ番号入力による直接ジャンプ
  - 端をクリックでページ送り

- **拡大縮小のバリエーション**
  - フィット（幅フィット / 高さフィット / 全体フィット）
  - 100%表示 / 任意のズームレベル（例: 50 / 75 / 100 / 150 / 200%）
  - ダブルクリック / ダブルタップでズームイン・アウト
  - ドラッグでパン（移動）

#### ZIP / ファイル入出力

- **ローカルファイル選択以外の手段**
  - ドラッグ＆ドロップで ZIP を投げ込める
  - 最近開いた ZIP の履歴（ブラウザの localStorage に保持）

- **ZIP 内容の柔軟な扱い**
  - サブフォルダを含む ZIP に対応
  - 画像以外のファイル（TXT, JSON）を無視

#### 操作性・UI

- **キーボードショートカットの明示**
  - `←/→`：ページ移動
  - `Space / Backspace`：ページ送り / 戻り
  - `+/-`：ズームイン・アウト
  - `F`：フィットモード切替
  - `T`：目次表示/非表示
  - `D`：ダークモード切替

- **モバイル / タブレット操作**
  - スワイプでページ送り
  - ピンチズーム（可能なら）

#### PWAまわり

- **PWA **
  - オフライン時でも「直前に開いた作品」はキャッシュから再閲覧可能
  - アイコン・スプラッシュスクリーンの指定（Android/Chromium / iOS Safari を意識）
  - `display: standalone` など、ホーム画面追加前提の設定

### 2. 品質面（UX・アクセシビリティ・パフォーマンス）

#### アクセシビリティ

- **基本アクセシビリティ要件**
  - キーボード操作で全機能にアクセス可能
  - 主要ボタンに `aria-label` 付与
  - コントラスト比が WCAG 2.1 AA を満たす配色

#### パフォーマンス

- **画像ロードの最適化**
  - 先読み：現在ページの±数ページを先読みしてページ送りを高速化
  - サムネイル用に縮小版を生成してキャッシュ
  - 大きすぎる画像は Web Worker or offscreen canvas で縮小

### 3. 開発・アーキテクチャ面

#### アーキテクチャ / 状態管理

- **状態管理のポリシー明示**
  - ページ番号、読書設定（ズーム、読書方向、テーマなど）はグローバル state（例：Redux Toolkit / Zustand / Recoil / React Context のいずれか）で管理
  - 設定は localStorage に永続化（ダークモード、言語、読書方向）

#### テスト

- **テスト要件**
  - ユニットテスト: Jest + Testing Library で主要コンポーネントをテスト
  - E2E テスト: Playwright or Cypress で以下を検証
    - ZIP をアップロードしてページ送りできる
    - PWA としてインストール可能
    - i18n の文言切り替えが動く

- **CI でのテスト実行**
  - GitHub Actions 上で lint / test / build を自動実行（main への push / PR 時）

#### コード品質

- **Lint / Format の強化**
  - ESLint + TypeScript + React Hooks ルール
  - Prettier と整合性のとれる ESLint 設定
  - pre-commit で `lint`, `format`, `type-check` を実行

- **型安全性**
  - `strict: true` の TypeScript 設定
  - ZIP ファイル内の TOC フォーマットなど用に型定義（`types/zip.ts` など）

### 4. i18n / 設定まわり

#### i18n

- **i18n の詳細要件**
  - `react-i18next` などを利用
  - 対応言語: 日本語 / 英語（最低2言語）
  - ブラウザ言語の自動検出 + 手動切り替え UI
  - テキストはすべて翻訳キー経由で管理（直書き禁止）

#### 設定（Preferences）

- 設定メニューで以下を切り替え可能：
  - テーマ（ライト / ダーク / システム追従）
  - 読み方向（右→左 / 左→右）
  - 見開きのオン / オフ
  - キーボードショートカットの簡易ヘルプ表示

### 5. デプロイ・運用まわり

#### GitHub Pages / Actions

- **CI/CD の詳細**
  - main ブランチへの push で自動デプロイ（`vite build` → `gh-pages` ブランチへデプロイ）
  - `lint` / `test` が失敗したらデプロイを止める
  - キャッシュを利用して `npm ci` を高速化

- **環境情報の明示**
  - README に Node.js の推奨バージョン、`pnpm` / `npm` / `yarn` どれ推奨かを明記

#### バージョニングとライセンス

- MIT ライセンスに加えて：
  - `package.json` にリポジトリ URL / author / license を記載
  - README にライセンス章と、使用ライブラリのライセンスへのリンク

### 6. ドキュメント

- **README に含めたい追加情報**
  - サポートブラウザ（Chrome / Edge / Firefox / Safari のバージョンレンジ）
  - ZIP の推奨構造例（スクリーンショット付き）
  - PWA のインストール手順（PC / モバイル）
  - 開発フロー例：`npm run dev` → `npm run test` → `npm run build` の説明

## 完了要件

完了要件は以下の通りです。

- 上記の要件を満たすこと
- コードが適切に構造化されていること
- 適切なコメントが含まれていること
- Github Actionsによるデプロイが完了し、ページが正しく表示されること(ただし環境変数などでユーザーのアクションが必要な場合は除く)
- README.mdにプロジェクトの説明、セットアップ方法、使用方法が記載されていること
- 適切なライセンスが含まれていること(MITでOK)
- .gitignoreが含まれていること

ユーザーのメールアドレスとユーザー名は以下の通りです。

- メールアドレス: 40634644+u-haru@users.noreply.github.com
- ユーザー名: u-haru

## 注意:

コマンド実行には権限が必要な場合があります。

データ削除などは慎重に行ってください。特にパスに~や$HOMEが含まれる場合は注意が必要です。ユーザーに確認を取ってください。
